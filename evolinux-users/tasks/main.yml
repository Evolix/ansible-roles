---

- fail:
    msg: only compatible with Debian >= 8
  when:
  - ansible_distribution != "Debian" or ansible_distribution_major_version | version_compare('8', '<')

- debug:
    msg: "Warning: empty 'evolinux_users' variable, tasks will be skipped!"
  when: evolinux_users == {}

- block:
  - include: account.yml

  - include: ssh.yml

  - include: sudo_jessie.yml
    when: ansible_distribution_release == "jessie"

  - include: sudo_stretch.yml
    when: ansible_distribution_major_version | version_compare('9', '>=')

  - meta: flush_handlers
  when: evolinux_users != {}

- include: root_disable_ssh.yml
  when: evolinux_root_disable_ssh
