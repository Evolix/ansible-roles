---

- name: Copy MySQL config files
  copy:
    src: "{{ item.file }}"
    dest: "/etc/mysql/conf.d/{{ item.file }}"
    owner: root
    group: root
    mode: "{{ item.mode }}"
  with_items:
    - { file: z_evolinux.cnf, mode: 0644 }
    - { file: zzz_evolinux.cnf, mode: 0640 }
  tags:
    - mysql

- name: Custom MySQL config
  ini_file:
    dest: /etc/mysql/conf.d/zzz_evolinux.cnf
    section: mysqld
    option: '{{ item.option }}'
    value: '{{ item.value }}'
  with_items:
    - { option: thread_cache_size, value: '{{ mysql_thread_cache_size }}' }
    - { option: innodb_buffer_pool_size, value: '{{ mysql_innodb_buffer_pool_size }}' }
  tags:
    - mysql
