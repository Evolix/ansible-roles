---

- name: Copy Evolinux defaults
  copy:
    src: evolinux-defaults.cnf
    dest: /etc/mysql/conf.d/000-evolinux-defaults.cnf
    mode: 0640
  tags:
    - mysql

- name: Custom mysqld config values
  ini_file:
    dest: /etc/mysql/conf.d/100-evolinux-custom.cnf
    section: mysqld
    option: '{{ item.option }}'
    value: '{{ item.value }}'
  with_items:
    - { option: thread_cache_size, value: '{{ mysql_thread_cache_size }}' }
    - { option: innodb_buffer_pool_size, value: '{{ mysql_innodb_buffer_pool_size }}' }
  tags:
    - mysql
