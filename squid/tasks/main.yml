---

- name: package is installed
  apt:
    name: squid3
    state: present

- name: squid.conf is present
  template:
    src: squid.j2
    dest: /etc/squid3/squid.conf
  notify: restart squid

- name: logrotate configuration
  copy:
    src: logrotate_squid3
    dest: /etc/logrotate.d/squid3

- name: evolix whitelist is present
  copy:
    src: whitelist-evolinux.conf
    dest: /etc/squid3/whitelist-evolinux.conf
    force: yes
    backup: yes
  notify: restart squid

- name: custom whitelist is present
  copy:
    src: whitelist-custom.conf
    dest: /etc/squid3/whitelist-custom.conf
    force: no
  notify: restart squid

- include: logrotate.yml

- include: minifirewall.yml

- include: log2mail.yml
