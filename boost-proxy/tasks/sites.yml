---

# HAProxy

- name: Create HAProxy sites parent directory
  file:
    dest: "/etc/haproxy/sites"
    owner: root
    group: root
    mode: "0755"
    state: directory
  tags:
    - haproxy
    - config

# Varnish

- name: Create Varnish sites parent directory
  file:
    dest: "/etc/varnish/sites"
    owner: root
    group: root
    mode: "0755"
    state: directory
  tags:
    - varnish
    - config

# Each site

- name: Create site configuration
  include: site.yml
  loop: "{{ boost_sites_enabled }}"
  loop_control:
    loop_var: site
  when:
    - boost_sites_enabled | length > 0
  tags:
    - haproxy
    - config
    - update-config
