---

- name: /usr/share/scripts exists
  file:
    dest: /usr/share/scripts
    mode: "0700"
    owner: root
    group: wheel
    state: directory
  tags:
    - evomaintenance

- name: Script is installed
  copy:
    src: evomaintenance.sh
    dest: /usr/share/scripts/evomaintenance.sh
    mode: "0700"
    owner: root
    group: wheel
    force: yes
    backup: yes
  tags:
    - evomaintenance

- name: Template is installed
  copy:
    src: evomaintenance.tpl
    dest: /usr/share/scripts/evomaintenance.tpl
    mode: "0600"
    owner: root
    group: wheel
    force: yes
    backup: yes
  tags:
    - evomaintenance

- name: Configuration is installed
  template:
    src: evomaintenance.j2
    dest: /etc/evomaintenance.cf
    owner: root
    group: wheel
    mode: "0600"
    force: "{{ evomaintenance_force_config | bool }}"
  tags:
    - evomaintenance
