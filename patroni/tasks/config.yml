---

- name: Create a password for PostgreSQL repl user
  command: "apg -M LCN -n1 -m 16"
  register: patroni_postgresql_replication_password
  check_mode: no

- name: Create a password for PostgreSQL superuser user
  command: "apg -M LCN -n1 -m 16"
  register: patroni_postgresql_superuser_password
  check_mode: no

- name: Create Patroni config file
  ansible.builtin.template:
    src: config.j2
    dest: /etc/patroni/config.yml
    owner: root
    group: root
    mode: "0644"